# CRM重构白皮书


### 前世今生

不知不觉中CRM系统已经快要1岁了。在这几个月的时间里，整个团队完成了从0到1，从1到N的过程，这是值得肯定的地方。

但是，正如同中国的经济一样，在经历过高速的发展期后，必然需要停顿那么一下，来进行产业结构的调整，我们的系统也是一样的。目前系统的库扩展性跟可维护性都已经亮起了红灯，下面我将从几个不同的角度总结一下现在系统的主要矛盾。然后，对症下药，提出重构方案。

* 需求管理方面
	*  首先，对于需求的讨论不够。合理的需求实现了，不合理的需求也实现了。
	*  第二，某些需求实现的方法不正确。使用方提供的需求，是非常感性的。我们需要对这些需求进行抽象与归纳，然后才是具体的实现，这一步是缺失的。
	*  第三，需求无文档。这直接导致无法进行系统的分析。

* 技术方面
	* __系统结构设计不合理，充分的展现了第内聚，高耦合的特点。__（比如，clue的create操作，散落在每一个业务逻辑中，当需要添加默认数值的时候，需要在整个项目中寻找所有的sql操作，进行修改。再比如，在clue的创建方法中还有创建操作日志的动作。等等）
	* __采用技术老旧。__（比如：使用的bodyParser无法自动完成序列化与反序列化。这种公共的东西还需要出现在业务代码当中等）
	* __api设计混乱。__ （比如：clue的put操作，出现了各种不同的api。前端还需要给每个api传递不同格式的参数）
	* __权限系统接近崩溃。__ 原有的权限的设计依然不能满足现有的也无需求，

综上所述，我认为重构可以需要经过一下几个步骤：  

1. 对现有需求进行充分的扬弃。充分的讨论每个需求的必要性，实现方式，最终形成一个完整的需求文档。
2. 根据需求文档

