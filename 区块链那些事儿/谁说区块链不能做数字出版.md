## 架构
![结构图](http://7xovlo.com1.z0.glb.clouddn.com/%E6%9E%B6%E6%9E%84.jpg)

#### 注解

* 在这个系统总，中心化的server首先是一个区块链中的全节点，同时也担任了类似于CDN的概念。存储，用户创作的内容
* client，可以简单的类比为轻钱包，每个client使用的是基于区块链的公私钥账户系统，但是他们不直接与区块链的p2p网络连接，而是与中心化server相连接。同时对于用户来说是一个非常好的写作工具和阅读工具

## 流程

为了提高可读性，这里以故事的方式，来描述这个系统的工作原理

#### 人物介绍

* lc：是一个年轻有为的作家
* 孙悟空：孙悟空是一个读者

#### 故事

__story1__

* lc下载并打开clinet，输入密码
* client根据密码生成公私钥，公钥作为账户，私钥作为数字指纹
* lc完成了注册


__story2__

* lc打开client，在设置中将md配置为默认写作工具
* lc新建了了一篇文章，取名为《费尔巴哈提纲的启示》，开始了他的文学创作旅程，client将文章持久化到本地硬盘当中，版本号为0
* 30秒过后，client从本地磁盘中读取这篇文章，用公钥加密后，发送到中心化server
* 中心server将client发送的数据存储到一个k-v数据库中
	* key：公钥:文章名称:版本号
	* value：client使用公钥加密的数据

__story3__

* lc完成了一天的创作，为了在以后发生版权纠纷的时候提供有力证据，他将这篇文章作为创作路径当中的一个节点记录下来，于是lc点击了记录创作路径按钮
* client接受指令后，首先将本地文章发送到server
* 然后升级本地存储的版本号为1
* server接受到文章后，更新本地k-v数据库的内容
* 然后将数据sha256，将hash后的结果生成记录类型的交易，向p2p网络广播
* server将内容拷贝到公钥:文章名称:1的key下，进行存储


__story4__

* lc到公司后，也下载了一个client，通过同样的密码登录
* client在登录后，链接到中心服务器，将公钥账户下的每篇文章的最新版本同步到本地
* lc打开前几天写的《费尔巴哈提纲的启示》，进行修改，client不断的进行持久化，并且每隔30秒将文章同步到中心服务器上
* lc又一次的将这个阶段的记录到了创作路径当中，server和本地的版本号升级到了2


__story5__

* lc终于完成了《费尔巴哈提纲的启示》，点击了client上个的分享按钮，选择，分享到朋友圈
* client，将文章用server官方的公钥加密，发送到server
* server，用自己的密钥解密后，与微信服务器交流，生成分享

__story6__

* 《费尔巴哈提纲的启示》在朋友圈分享后，很受欢迎。lc再接再厉，创作了一系列的马哲方面的文章，深受好评
* lc通过client将这些文章打包成一本书，并设置了书的价格，以及每一笔交易的中介费用
* client将这份声明和文章的数据使用官方的公钥加密后发送给server
* server接受数据，将创作的数据放到官方账号的存储空间下。然后将声明放到商城中展示

__story7__


